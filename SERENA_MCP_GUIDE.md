# Serena MCP 使用ガイド

## 概要

Serena MCPが正常に導入されました。このガイドでは、市場レポート生成プロジェクトでSerena MCPを効果的に活用する方法を説明します。

## Serena MCPとは

Serena MCPは、AI駆動のコーディング支援ツールで、以下の機能を提供します：

- **セマンティックコード検索**: プロジェクト全体から関連するコードを意味的に検索
- **インテリジェントコード編集**: コンテキストを理解した自動コード生成・修正
- **プロジェクト構造解析**: 複雑なコードベースの構造と依存関係の理解
- **コード品質向上**: ベストプラクティスに基づく提案

## セットアップ状況

✅ **uvパッケージマネージャー**: インストール済み (v0.7.15)  
✅ **Claude Desktop設定**: 設定完了  
✅ **プロジェクト設定**: .gitignore更新済み  
✅ **動作確認**: 正常に動作  

## 使用方法

### 1. Claude Desktopの再起動

設定を反映するため、Claude Desktopを再起動してください。

### 2. 基本的な使用例

#### コード検索
```
「データ取得に関するコードを教えて」
「チャート生成の処理がどこにあるか教えて」
「エラーハンドリングの実装を確認したい」
```

#### コード解析
```
「このプロジェクトの全体的な構造を説明して」
「main.pyの処理フローを解析して」
「パフォーマンスのボトルネックを見つけて」
```

#### コード改善提案
```
「このコードをもっと効率的にできるか」
「エラーハンドリングを改善できるか」
「コードの可読性を向上させる方法は」
```

### 3. 市場レポートプロジェクト特有の活用例

#### データ処理の最適化
```
「金融データの処理速度を向上させる方法を提案して」
「yfinanceを使ったデータ取得部分を最適化して」
```

#### チャート生成の改善
```
「plotlyのチャート生成コードを見直して」
「より美しいチャートを作るための改善点を教えて」
```

#### レポート生成の効率化
```
「HTMLレポート生成の処理を並列化できるか」
「テンプレートエンジンの使い方を最適化して」
```

## 高度な機能

### プロジェクト固有の設定

Serena MCPは以下のプロジェクト設定を自動認識します：

- **Python環境**: venv/環境の自動検出
- **依存関係**: requirements.txtの解析
- **設定ファイル**: config/内の設定ファイル群
- **テストファイル**: tests/ディレクトリ内のテスト

### パフォーマンス最適化

大規模プロジェクトでの使用時の注意点：

1. **初回起動**: 言語サーバーの初期化に時間がかかる場合があります
2. **メモリ使用量**: 大量のファイルを解析する際はメモリ使用量に注意
3. **ネットワーク**: インターネット接続が必要です

## トラブルシューティング

### よくある問題と解決策

#### Serena MCPが表示されない
1. Claude Desktopを完全に再起動
2. 設定ファイルの構文エラーチェック
3. uvのバージョン確認

#### 動作が遅い
1. プロジェクトサイズが大きい場合は初回起動に時間がかかります
2. 必要に応じてファイル除外設定を追加

#### エラーが発生する
1. Python環境の確認
2. 依存関係の確認
3. ログの確認

### ログの確認方法

```bash
# Serena MCPサーバーのログを直接確認
uvx --from git+https://github.com/oraios/serena serena-mcp-server --log-level DEBUG
```

## 設定ファイル

### Claude Desktop設定ファイルの場所
```
~/Library/Application Support/Claude/claude_desktop_config.json
```

### 現在の設定
```json
{
  "mcpServers": {
    "serena": {
      "command": "uvx",
      "args": [
        "--from", 
        "git+https://github.com/oraios/serena",
        "serena-mcp-server"
      ],
      "env": {
        "UV_SYSTEM_PYTHON": "1"
      }
    }
  }
}
```

## プロジェクト特有のヒント

### 金融データ処理での活用
- データフィードの最適化提案
- エラーハンドリングの強化提案
- パフォーマンス改善のアドバイス

### チャート生成での活用
- 視覚化の改善提案
- インタラクティブ要素の追加
- レスポンシブデザインの実装

### レポート生成での活用
- テンプレートの最適化
- 自動化処理の改善
- 出力形式の多様化

## 更新とメンテナンス

### Serena MCPの更新
```bash
# 最新版の確認・更新（自動で最新のコミットを取得）
uvx --from git+https://github.com/oraios/serena serena-mcp-server --help
```

### 設定の変更
設定を変更した場合は、Claude Desktopの再起動が必要です。

## 参考リンク

- [Serena MCP公式リポジトリ](https://github.com/oraios/serena)
- [Model Context Protocol (MCP)](https://docs.anthropic.com/en/docs/mcp)
- [uvパッケージマネージャー](https://docs.astral.sh/uv/)

---

**注意**: Serena MCPは開発中のツールのため、定期的な更新が推奨されます。新機能や改改善が継続的に追加されています。